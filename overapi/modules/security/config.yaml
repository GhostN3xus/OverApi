###############################################################################
# OverApi Security Modules Configuration
# This file configures all advanced security testing modules
###############################################################################

jwt_analyzer:
  enabled: true
  timeout: 30
  test_endpoints:
    - /api/user/profile
    - /api/auth/login
    - /api/auth/token
    - /api/me
    - /api/account

  tests:
    algorithm_none: true
    algorithm_confusion: true
    weak_secret_bruteforce: true
    kid_injection: true
    jku_x5u_injection: true
    claims_manipulation: true
    token_substitution: true
    expired_token: true
    missing_expiration: true
    weak_algorithm: true

  weak_secrets_list:
    - secret
    - secret123
    - password
    - password123
    - admin
    - test
    - jwt_secret
    - mykey

business_logic_scanner:
  enabled: true
  timeout: 30

  race_conditions:
    enabled: true
    parallel_requests: 50
    test_endpoints:
      - /api/wallet/withdraw
      - /api/coupon/redeem
      - /api/order/create
      - /api/payment/process

  mass_assignment:
    enabled: true
    test_fields:
      - role
      - is_admin
      - is_verified
      - balance
      - credits
      - permissions

  price_manipulation:
    enabled: true
    test_values:
      negative: [-1, -100, -999999]
      zero: [0, 0.0]
      decimal: [0.001, 0.0001]
      overflow: [999999999, 2147483647]

  workflow_bypass:
    enabled: true
    workflows:
      - name: checkout
        steps: [cart, address, payment, confirm]
      - name: registration
        steps: [signup, verify_email, complete_profile]

  rate_limit_evasion:
    enabled: true

  integer_overflow:
    enabled: true

graphql_attacker:
  enabled: true
  graphql_endpoint: /graphql
  timeout: 30

  tests:
    introspection: true
    batch_query_dos: true
    circular_query: true
    field_suggestion: true
    directive_abuse: true
    alias_dos: true
    no_depth_limit: true

  limits:
    max_batch_size: 100
    max_nesting_depth: 15
    max_aliases: 50

ssrf_tester:
  enabled: true
  collaborator_url: null
  timeout: 30

  tests:
    webhook_injection: true
    blind_ssrf: true
    internal_port_scan: true

  webhook_parameters:
    - callback_url
    - webhook_url
    - redirect_uri
    - image_url
    - import_url

  cloud_targets:
    - 169.254.169.254

  internal_targets:
    - localhost
    - 127.0.0.1

  internal_ports:
    - 22
    - 23
    - 80
    - 443
    - 3306
    - 5432
    - 6379
    - 8080
    - 8443
    - 9200

reporting:
  enabled: true

  formats:
    html: true
    json: true
    pdf: false

  output_dir: ./reports

  templates:
    use_custom: false
    template_path: null

  compliance_frameworks:
    - OWASP_API_Top_10
    - PCI_DSS
    - NIST
    - ISO_27001
    - SOC2

general:
  log_level: INFO
  verbose: false
  max_workers: 10
  retry_attempts: 3
  retry_delay: 1
